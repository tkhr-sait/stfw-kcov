var data = {lines:[
{"lineNum":"    1","line":"#!/bin/bash"},
{"lineNum":"    2","line":"#set -ex"},
{"lineNum":"    3","line":"#==================================================================================================="},
{"lineNum":"    4","line":"#"},
{"lineNum":"    5","line":"# scenario test framework cli - scenario runner"},
{"lineNum":"    6","line":"#"},
{"lineNum":"    7","line":"#==================================================================================================="},
{"lineNum":"    8","line":"#---------------------------------------------------------------------------------------------------"},
{"lineNum":"    9","line":"# 設定"},
{"lineNum":"   10","line":"#---------------------------------------------------------------------------------------------------"},
{"lineNum":"   11","line":"dir_script=\"$(dirname $0)\"","class":"lineCov","hits":"1","order":"1440",},
{"lineNum":"   12","line":"cd \"$(cd ${dir_script}; pwd)\"","class":"lineCov","hits":"1","order":"1441",},
{"lineNum":"   13","line":""},
{"lineNum":"   14","line":"# 共通設定"},
{"lineNum":"   15","line":"readonly STFW_HOME=\"$(cd ../..; pwd)\"","class":"lineCov","hits":"1","order":"1442",},
{"lineNum":"   16","line":". \"${STFW_HOME}/bin/lib/setenv\"","class":"lineCov","hits":"1","order":"1443",},
{"lineNum":"   17","line":""},
{"lineNum":"   18","line":"# stfw generate共通ユーティリティ"},
{"lineNum":"   19","line":". \"${DIR_BIN_LIB}/stfw_generate_utils\"","class":"lineCov","hits":"1","order":"1444",},
{"lineNum":"   20","line":"# stfw digdag共通ユーティリティ"},
{"lineNum":"   21","line":". \"${DIR_BIN_LIB}/stfw_digdag_utils\"","class":"lineCov","hits":"1","order":"1445",},
{"lineNum":"   22","line":""},
{"lineNum":"   23","line":"readonly PROGNAME=\"stfw $(basename $0)\"","class":"lineCov","hits":"1","order":"1446",},
{"lineNum":"   24","line":""},
{"lineNum":"   25","line":""},
{"lineNum":"   26","line":""},
{"lineNum":"   27","line":"#---------------------------------------------------------------------------------------------------"},
{"lineNum":"   28","line":"# 関数定義"},
{"lineNum":"   29","line":"#---------------------------------------------------------------------------------------------------"},
{"lineNum":"   30","line":"function private.description() {"},
{"lineNum":"   31","line":"  echo \"  $(basename $0) <scenario-names...> : run a scenario\"","class":"lineNoCov","hits":"0",},
{"lineNum":"   32","line":"}"},
{"lineNum":"   33","line":""},
{"lineNum":"   34","line":""},
{"lineNum":"   35","line":"function private.usage() {"},
{"lineNum":"   36","line":"  cat << __EOT__ >&2","class":"lineNoCov","hits":"0",},
{"lineNum":"   37","line":"usage: ${PROGNAME} [options...] <scenario-names...>"},
{"lineNum":"   38","line":""},
{"lineNum":"   39","line":"options:"},
{"lineNum":"   40","line":"  -d, --dry-run                       : dry-run mode doesn\'t execute tasks"},
{"lineNum":"   41","line":"  -f, --follow                        : show new logs until attempt or task finishes"},
{"lineNum":"   42","line":"  -s, --setup <scenario-names...>     : run setup scripts"},
{"lineNum":"   43","line":"  -t, --teardown <scenario-names...>  : run teardown scripts"},
{"lineNum":"   44","line":""},
{"lineNum":"   45","line":"__EOT__"},
{"lineNum":"   46","line":"  exit ${EXITCODE_ERROR}","class":"lineNoCov","hits":"0",},
{"lineNum":"   47","line":"}"},
{"lineNum":"   48","line":""},
{"lineNum":"   49","line":""},
{"lineNum":"   50","line":"function private.get_uniq_id() {"},
{"lineNum":"   51","line":"  echo \"$(date \'+%Y%m%d%H%M%S\')_$$\"","class":"lineCov","hits":"1","order":"1447",},
{"lineNum":"   52","line":"}"},
{"lineNum":"   53","line":""},
{"lineNum":"   54","line":""},
{"lineNum":"   55","line":"function private.get_run_id() {"},
{"lineNum":"   56","line":"  echo \"_$(private.get_uniq_id)\"","class":"lineCov","hits":"1","order":"1448",},
{"lineNum":"   57","line":"}"},
{"lineNum":"   58","line":""},
{"lineNum":"   59","line":""},
{"lineNum":"   60","line":"function private.setup() {"},
{"lineNum":"   61","line":"  log.func_start_trace \"$@\"","class":"lineNoCov","hits":"0",},
{"lineNum":"   62","line":"  local _retcode=${EXITCODE_SUCCESS}","class":"lineNoCov","hits":"0",},
{"lineNum":"   63","line":""},
{"lineNum":"   64","line":"  # 組み込みplugin.setup"},
{"lineNum":"   65","line":"  local _sect_name=\"run-embedded-setup\"","class":"lineNoCov","hits":"0",},
{"lineNum":"   66","line":"  log.sect_start_debug \"${_sect_name}\"","class":"lineNoCov","hits":"0",},
{"lineNum":"   67","line":"  local _dir_embed_setup=\"${DIR_PLUGIN}/run/__common/setup\"","class":"lineNoCov","hits":"0",},
{"lineNum":"   68","line":"  stfw.bulk_exec_scripts \"${_dir_embed_setup}\"","class":"lineNoCov","hits":"0",},
{"lineNum":"   69","line":"  _retcode=$?","class":"lineNoCov","hits":"0",},
{"lineNum":"   70","line":"  log.sect_end_debug \"${_sect_name}\" \"${_retcode}\"","class":"lineNoCov","hits":"0",},
{"lineNum":"   71","line":"  if [[ ${_retcode} -ne ${EXITCODE_SUCCESS} ]]; then return ${_retcode}; fi","class":"lineNoCov","hits":"0",},
{"lineNum":"   72","line":""},
{"lineNum":"   73","line":"  # プロジェクトplugin.setup"},
{"lineNum":"   74","line":"  _sect_name=\"run-project-setup\"","class":"lineNoCov","hits":"0",},
{"lineNum":"   75","line":"  log.sect_start_debug \"${_sect_name}\"","class":"lineNoCov","hits":"0",},
{"lineNum":"   76","line":"  local _dir_proj_setup=\"$(stfw.get_plugin_path run/_common/setup)\"","class":"lineNoCov","hits":"0",},
{"lineNum":"   77","line":"  if [[ \"${_dir_proj_setup}x\" != \"x\" ]]; then","class":"lineNoCov","hits":"0",},
{"lineNum":"   78","line":"    stfw.bulk_exec_scripts \"${_dir_proj_setup}\"","class":"lineNoCov","hits":"0",},
{"lineNum":"   79","line":"    _retcode=$?","class":"lineNoCov","hits":"0",},
{"lineNum":"   80","line":"  fi"},
{"lineNum":"   81","line":"  log.sect_end_debug \"${_sect_name}\" \"${_retcode}\"","class":"lineNoCov","hits":"0",},
{"lineNum":"   82","line":""},
{"lineNum":"   83","line":"  log.func_end_trace ${_retcode}","class":"lineNoCov","hits":"0",},
{"lineNum":"   84","line":"  return ${_retcode}","class":"lineNoCov","hits":"0",},
{"lineNum":"   85","line":"}"},
{"lineNum":"   86","line":""},
{"lineNum":"   87","line":""},
{"lineNum":"   88","line":"function private.teardown() {"},
{"lineNum":"   89","line":"  log.func_start_trace \"$@\"","class":"lineNoCov","hits":"0",},
{"lineNum":"   90","line":"  local _retcode=${EXITCODE_SUCCESS}","class":"lineNoCov","hits":"0",},
{"lineNum":"   91","line":""},
{"lineNum":"   92","line":"  # プロジェクトplugin.teardown"},
{"lineNum":"   93","line":"  local _sect_name=\"run-project-teardown\"","class":"lineNoCov","hits":"0",},
{"lineNum":"   94","line":"  log.sect_start_debug \"${_sect_name}\"","class":"lineNoCov","hits":"0",},
{"lineNum":"   95","line":"  local _dir_proj_teardown=\"$(stfw.get_plugin_path run/_common/teardown)\"","class":"lineNoCov","hits":"0",},
{"lineNum":"   96","line":"  if [[ \"${_dir_proj_teardown}x\" != \"x\" ]]; then","class":"lineNoCov","hits":"0",},
{"lineNum":"   97","line":"    stfw.bulk_exec_scripts \"${_dir_proj_teardown}\"","class":"lineNoCov","hits":"0",},
{"lineNum":"   98","line":"    _retcode=$?","class":"lineNoCov","hits":"0",},
{"lineNum":"   99","line":"  fi"},
{"lineNum":"  100","line":"  log.sect_end_debug \"${_sect_name}\" \"${_retcode}\"","class":"lineNoCov","hits":"0",},
{"lineNum":"  101","line":"  if [[ ${_retcode} -ne ${EXITCODE_SUCCESS} ]]; then return ${_retcode}; fi","class":"lineNoCov","hits":"0",},
{"lineNum":"  102","line":""},
{"lineNum":"  103","line":"  # 組み込みplugin.teardown"},
{"lineNum":"  104","line":"  _sect_name=\"run-embedded-teardown\"","class":"lineNoCov","hits":"0",},
{"lineNum":"  105","line":"  log.sect_start_debug \"${_sect_name}\"","class":"lineNoCov","hits":"0",},
{"lineNum":"  106","line":"  local _dir_embed_teardown=\"${DIR_PLUGIN}/run/__common/teardown\"","class":"lineNoCov","hits":"0",},
{"lineNum":"  107","line":"  stfw.bulk_exec_scripts \"${_dir_embed_teardown}\"","class":"lineNoCov","hits":"0",},
{"lineNum":"  108","line":"  _retcode=$?","class":"lineNoCov","hits":"0",},
{"lineNum":"  109","line":"  log.sect_end_debug \"${_sect_name}\" \"${_retcode}\"","class":"lineNoCov","hits":"0",},
{"lineNum":"  110","line":""},
{"lineNum":"  111","line":"  log.func_end_trace ${_retcode}","class":"lineNoCov","hits":"0",},
{"lineNum":"  112","line":"  return ${_retcode}","class":"lineNoCov","hits":"0",},
{"lineNum":"  113","line":"}"},
{"lineNum":"  114","line":""},
{"lineNum":"  115","line":""},
{"lineNum":"  116","line":"function private.gen_symlinks() {"},
{"lineNum":"  117","line":"  log.func_start_trace \"$@\"","class":"lineCov","hits":"1","order":"1449",},
{"lineNum":"  118","line":"  local _input_dir=\"$1\"","class":"lineCov","hits":"1","order":"1450",},
{"lineNum":"  119","line":"  local _output_dir=\"$2\"","class":"lineCov","hits":"1","order":"1451",},
{"lineNum":"  120","line":""},
{"lineNum":"  121","line":"  if [[ ! -d \"${_input_dir}\" ]]; then","class":"lineCov","hits":"1","order":"1452",},
{"lineNum":"  122","line":"    log.warn \"${_input_dir} is not exist.\"","class":"lineCov","hits":"1","order":"1453",},
{"lineNum":"  123","line":"    return ${EXITCODE_SUCCESS}","class":"lineCov","hits":"1","order":"1454",},
{"lineNum":"  124","line":"  fi"},
{"lineNum":"  125","line":""},
{"lineNum":"  126","line":"  local _tmp_dir_list=\"${STFW_PROJ_DIR_DATA}/${FUNCNAME[0]}_dir_$(private.get_uniq_id)\"","class":"lineCov","hits":"1","order":"1455",},
{"lineNum":"  127","line":"  local _tmp_file_list=\"${STFW_PROJ_DIR_DATA}/${FUNCNAME[0]}_file_$(private.get_uniq_id)\"","class":"lineCov","hits":"1","order":"1456",},
{"lineNum":"  128","line":""},
{"lineNum":"  129","line":"  # dir相対パスリスト作成"},
{"lineNum":"  130","line":"  find \"${_input_dir}\" -follow -type d                                                             | # ディレクトリリストから","class":"lineCov","hits":"1","order":"1457",},
{"lineNum":"  131","line":"  grep -v \"/\\.digdag\"                                                                              | # digdagデータディレクトリを除外","class":"lineCov","hits":"1","order":"1458",},
{"lineNum":"  132","line":"  grep -v \"^${_input_dir}$\"                                                                        | # 自ディレクトリを除外","class":"lineCov","hits":"1","order":"1459",},
{"lineNum":"  133","line":"  sed -e \"s|${_input_dir}/||\"                                                                      | # 相対パス化","class":"lineCov","hits":"1","order":"1460",},
{"lineNum":"  134","line":"  sort > ${_tmp_dir_list}","class":"lineCov","hits":"1","order":"1461",},
{"lineNum":"  135","line":""},
{"lineNum":"  136","line":"  # file相対パスリスト作成"},
{"lineNum":"  137","line":"  find \"${_input_dir}\" -follow -type f                                                             | # ファイルリストから","class":"lineCov","hits":"1","order":"1462",},
{"lineNum":"  138","line":"  grep -v \"/\\.digdag\"                                                                              | # digdagデータディレクトリを除外","class":"lineCov","hits":"1","order":"1463",},
{"lineNum":"  139","line":"  sed -e \"s|${_input_dir}/||\"                                                                      | # 相対パス化","class":"lineCov","hits":"1","order":"1464",},
{"lineNum":"  140","line":"  sort > ${_tmp_file_list}","class":"lineCov","hits":"1","order":"1465",},
{"lineNum":"  141","line":""},
{"lineNum":"  142","line":"  # dirリストループ"},
{"lineNum":"  143","line":"  grep -v \'^ *#\' < \"${_tmp_dir_list}\" | while IFS= read -r _cur_reldir; do","class":"lineCov","hits":"1","order":"1466",},
{"lineNum":"  144","line":"    # dir作成"},
{"lineNum":"  145","line":"    local _cur_output_dir=\"${_output_dir}/${_cur_reldir}\"","class":"lineCov","hits":"1","order":"1467",},
{"lineNum":"  146","line":"    if [[ ! -d \"${_cur_output_dir}\" ]]; then","class":"lineCov","hits":"1","order":"1468",},
{"lineNum":"  147","line":"      log.trace \"mkdir -p \\\"${_cur_output_dir}\\\"\"","class":"lineCov","hits":"1","order":"1469",},
{"lineNum":"  148","line":"      mkdir -p \"${_cur_output_dir}\"","class":"lineCov","hits":"1","order":"1470",},
{"lineNum":"  149","line":"    fi"},
{"lineNum":"  150","line":"  done"},
{"lineNum":"  151","line":""},
{"lineNum":"  152","line":"  # ファイルリストループ"},
{"lineNum":"  153","line":"  grep -v \'^ *#\' < \"${_tmp_file_list}\" | while IFS= read -r _cur_relfile; do","class":"lineCov","hits":"1","order":"1471",},
{"lineNum":"  154","line":"    # sym link作成"},
{"lineNum":"  155","line":"    local _cur_from_file=\"${_input_dir}/${_cur_relfile}\"","class":"lineCov","hits":"1","order":"1472",},
{"lineNum":"  156","line":"    local _cur_to_file=\"${_output_dir}/${_cur_relfile}\"","class":"lineCov","hits":"1","order":"1473",},
{"lineNum":"  157","line":"    log.trace \"ln -s \\\"${_cur_from_file}\\\" \\\"${_cur_to_file}\\\"\"","class":"lineCov","hits":"1","order":"1474",},
{"lineNum":"  158","line":"    ln -s \"${_cur_from_file}\" \"${_cur_to_file}\"","class":"lineCov","hits":"1","order":"1475",},
{"lineNum":"  159","line":"  done"},
{"lineNum":"  160","line":""},
{"lineNum":"  161","line":"  # 一時ファイルの削除"},
{"lineNum":"  162","line":"  rm -f \"${_tmp_dir_list}\"","class":"lineCov","hits":"1","order":"1476",},
{"lineNum":"  163","line":"  rm -f \"${_tmp_file_list}\"","class":"lineCov","hits":"1","order":"1477",},
{"lineNum":"  164","line":""},
{"lineNum":"  165","line":"  log.func_end_trace ${EXITCODE_SUCCESS}","class":"lineCov","hits":"1","order":"1478",},
{"lineNum":"  166","line":"  return ${EXITCODE_SUCCESS}","class":"lineCov","hits":"1","order":"1479",},
{"lineNum":"  167","line":"}"},
{"lineNum":"  168","line":""},
{"lineNum":"  169","line":""},
{"lineNum":"  170","line":"function private.gen_symlink_digdag_proj() {"},
{"lineNum":"  171","line":"  log.func_start_trace \"$@\"","class":"lineCov","hits":"1","order":"1480",},
{"lineNum":"  172","line":""},
{"lineNum":"  173","line":"  local _digdag_proj_dir=\"$1\"","class":"lineCov","hits":"1","order":"1481",},
{"lineNum":"  174","line":"  shift","class":"lineCov","hits":"1","order":"1482",},
{"lineNum":"  175","line":"  local _target_scenarios=( \"$@\" )","class":"lineCov","hits":"1","order":"1483",},
{"lineNum":"  176","line":""},
{"lineNum":"  177","line":"  # 起動設定"},
{"lineNum":"  178","line":"  ln -sf \"${PATH_PROJ_CONFIG}\" \"${_digdag_proj_dir}/$(basename ${PATH_PROJ_CONFIG})\"","class":"lineCov","hits":"1","order":"1484",},
{"lineNum":"  179","line":"  # config"},
{"lineNum":"  180","line":"  private.gen_symlinks \"${STFW_PROJ_DIR}/config\" \"${_digdag_proj_dir}/config\"","class":"lineCov","hits":"1","order":"1485",},
{"lineNum":"  181","line":"  # plugins"},
{"lineNum":"  182","line":"  private.gen_symlinks \"${STFW_PROJ_DIR}/plugins\" \"${_digdag_proj_dir}/plugins\"","class":"lineCov","hits":"1","order":"1486",},
{"lineNum":"  183","line":"  # modules"},
{"lineNum":"  184","line":"  private.gen_symlinks \"${STFW_PROJ_DIR}/modules\" \"${_digdag_proj_dir}/modules\"","class":"lineCov","hits":"1","order":"1487",},
{"lineNum":"  185","line":"  # scenario"},
{"lineNum":"  186","line":"  for _cur_scenario in ${_target_scenarios[*]}; do","class":"lineCov","hits":"1","order":"1488",},
{"lineNum":"  187","line":"    private.gen_symlinks \"${STFW_PROJ_DIR}/scenario/${_cur_scenario}\" \"${_digdag_proj_dir}/scenario/${_cur_scenario}\"","class":"lineCov","hits":"1","order":"1489",},
{"lineNum":"  188","line":"  done"},
{"lineNum":"  189","line":""},
{"lineNum":"  190","line":"  log.func_end_trace ${EXITCODE_SUCCESS}","class":"lineCov","hits":"1","order":"1490",},
{"lineNum":"  191","line":"}"},
{"lineNum":"  192","line":""},
{"lineNum":"  193","line":""},
{"lineNum":"  194","line":"function private.move_dig_files() {"},
{"lineNum":"  195","line":"  log.func_start_trace \"$@\"","class":"lineCov","hits":"1","order":"1491",},
{"lineNum":"  196","line":"  local _input_dir=\"$1\"","class":"lineCov","hits":"1","order":"1492",},
{"lineNum":"  197","line":"  local _output_dir=\"$2\"","class":"lineCov","hits":"1","order":"1493",},
{"lineNum":"  198","line":""},
{"lineNum":"  199","line":"  if [[ ! -d \"${_input_dir}\" ]]; then","class":"lineCov","hits":"1","order":"1494",},
{"lineNum":"  200","line":"    log.warn \"${_input_dir} is not exist.\"","class":"lineNoCov","hits":"0",},
{"lineNum":"  201","line":"    return ${EXITCODE_SUCCESS}","class":"lineNoCov","hits":"0",},
{"lineNum":"  202","line":"  fi"},
{"lineNum":"  203","line":""},
{"lineNum":"  204","line":"  local _tmp_dir_list=\"${STFW_PROJ_DIR_DATA}/${FUNCNAME[0]}_dir_$(private.get_uniq_id)\"","class":"lineCov","hits":"1","order":"1495",},
{"lineNum":"  205","line":"  local _tmp_file_list=\"${STFW_PROJ_DIR_DATA}/${FUNCNAME[0]}_file_$(private.get_uniq_id)\"","class":"lineCov","hits":"1","order":"1496",},
{"lineNum":"  206","line":""},
{"lineNum":"  207","line":"  # dir相対パスリスト作成"},
{"lineNum":"  208","line":"  find \"${_input_dir}\" -follow -type d                                                             | # ディレクトリリストから","class":"lineCov","hits":"1","order":"1497",},
{"lineNum":"  209","line":"  grep -v \"/\\.digdag\"                                                                              | # digdagデータディレクトリを除外","class":"lineCov","hits":"1","order":"1498",},
{"lineNum":"  210","line":"  grep -v \"^${_input_dir}$\"                                                                        | # 自ディレクトリを除外","class":"lineCov","hits":"1","order":"1499",},
{"lineNum":"  211","line":"  sed -e \"s|${_input_dir}/||\"                                                                      | # 相対パス化","class":"lineCov","hits":"1","order":"1500",},
{"lineNum":"  212","line":"  sort > ${_tmp_dir_list}","class":"lineCov","hits":"1","order":"1501",},
{"lineNum":"  213","line":""},
{"lineNum":"  214","line":"  # file相対パスリスト作成"},
{"lineNum":"  215","line":"  find \"${_input_dir}\" -follow -type f -name \"*.dig\"                                               | # digファイルリストから","class":"lineCov","hits":"1","order":"1502",},
{"lineNum":"  216","line":"  grep -v \"/\\.digdag\"                                                                              | # digdagデータディレクトリを除外","class":"lineCov","hits":"1","order":"1503",},
{"lineNum":"  217","line":"  sed -e \"s|${_input_dir}/||\"                                                                      | # 相対パス化","class":"lineCov","hits":"1","order":"1504",},
{"lineNum":"  218","line":"  sort > ${_tmp_file_list}","class":"lineCov","hits":"1","order":"1505",},
{"lineNum":"  219","line":""},
{"lineNum":"  220","line":"  # dirリストループ"},
{"lineNum":"  221","line":"  grep -v \'^ *#\' < \"${_tmp_dir_list}\" | while IFS= read -r _cur_reldir; do","class":"lineCov","hits":"1","order":"1506",},
{"lineNum":"  222","line":"    # dir作成"},
{"lineNum":"  223","line":"    local _cur_output_dir=\"${_output_dir}/${_cur_reldir}\"","class":"lineCov","hits":"1","order":"1507",},
{"lineNum":"  224","line":"    if [[ ! -d \"${_cur_output_dir}\" ]]; then","class":"lineCov","hits":"1","order":"1508",},
{"lineNum":"  225","line":"      log.trace \"mkdir -p \\\"${_cur_output_dir}\\\"\"","class":"lineCov","hits":"1","order":"1509",},
{"lineNum":"  226","line":"      mkdir -p \"${_cur_output_dir}\"","class":"lineCov","hits":"1","order":"1510",},
{"lineNum":"  227","line":"    fi"},
{"lineNum":"  228","line":"  done"},
{"lineNum":"  229","line":""},
{"lineNum":"  230","line":"  # ファイルリストループ"},
{"lineNum":"  231","line":"  grep -v \'^ *#\' < \"${_tmp_file_list}\" | while IFS= read -r _cur_relfile; do","class":"lineCov","hits":"1","order":"1511",},
{"lineNum":"  232","line":"    # sym link作成"},
{"lineNum":"  233","line":"    local _cur_from_file=\"${_input_dir}/${_cur_relfile}\"","class":"lineCov","hits":"1","order":"1512",},
{"lineNum":"  234","line":"    local _cur_to_file=\"${_output_dir}/${_cur_relfile}\"","class":"lineCov","hits":"1","order":"1513",},
{"lineNum":"  235","line":"    log.trace \"mv \\\"${_cur_from_file}\\\" \\\"${_cur_to_file}\\\"\"","class":"lineCov","hits":"1","order":"1514",},
{"lineNum":"  236","line":"    mv \"${_cur_from_file}\" \"${_cur_to_file}\"","class":"lineCov","hits":"1","order":"1515",},
{"lineNum":"  237","line":"  done"},
{"lineNum":"  238","line":""},
{"lineNum":"  239","line":"  # 一時ファイルの削除"},
{"lineNum":"  240","line":"  rm -f \"${_tmp_dir_list}\"","class":"lineCov","hits":"1","order":"1516",},
{"lineNum":"  241","line":"  rm -f \"${_tmp_file_list}\"","class":"lineCov","hits":"1","order":"1517",},
{"lineNum":"  242","line":""},
{"lineNum":"  243","line":"  log.func_end_trace ${EXITCODE_SUCCESS}","class":"lineCov","hits":"1","order":"1518",},
{"lineNum":"  244","line":"  return ${EXITCODE_SUCCESS}","class":"lineCov","hits":"1","order":"1519",},
{"lineNum":"  245","line":"}"},
{"lineNum":"  246","line":""},
{"lineNum":"  247","line":""},
{"lineNum":"  248","line":"function private.move_to_digdag_proj() {"},
{"lineNum":"  249","line":"  log.func_start_trace \"$@\"","class":"lineCov","hits":"1","order":"1520",},
{"lineNum":"  250","line":""},
{"lineNum":"  251","line":"  local _digdag_proj_dir=\"$1\"","class":"lineCov","hits":"1","order":"1521",},
{"lineNum":"  252","line":"  shift","class":"lineCov","hits":"1","order":"1522",},
{"lineNum":"  253","line":"  local _target_scenarios=( \"$@\" )","class":"lineCov","hits":"1","order":"1523",},
{"lineNum":"  254","line":""},
{"lineNum":"  255","line":"  # scenario配下のdigファイルを移動"},
{"lineNum":"  256","line":"  mkdir \"${_digdag_proj_dir}/scenario\"","class":"lineCov","hits":"1","order":"1524",},
{"lineNum":"  257","line":"  for _cur_scenario in ${_target_scenarios[*]}; do","class":"lineCov","hits":"1","order":"1525",},
{"lineNum":"  258","line":"    private.move_dig_files                                                                         \\","class":"lineNoCov","hits":"0",},
{"lineNum":"  259","line":"      \"${STFW_PROJ_DIR}/scenario/${_cur_scenario}\"                                                 \\"},
{"lineNum":"  260","line":"      \"${_digdag_proj_dir}/scenario/${_cur_scenario}\""},
{"lineNum":"  261","line":"  done"},
{"lineNum":"  262","line":""},
{"lineNum":"  263","line":"  log.func_end_trace ${EXITCODE_SUCCESS}","class":"lineCov","hits":"1","order":"1526",},
{"lineNum":"  264","line":"}"},
{"lineNum":"  265","line":""},
{"lineNum":"  266","line":""},
{"lineNum":"  267","line":"function private.restore_moved_digdag_proj() {"},
{"lineNum":"  268","line":"  log.func_start_trace \"$@\"","class":"lineCov","hits":"1","order":"1527",},
{"lineNum":"  269","line":""},
{"lineNum":"  270","line":"  local _digdag_proj_dir=\"$1\"","class":"lineCov","hits":"1","order":"1528",},
{"lineNum":"  271","line":"  # scenario配下のdigファイルを移動"},
{"lineNum":"  272","line":"  private.move_dig_files \"${_digdag_proj_dir}/scenario\" \"${STFW_PROJ_DIR}/scenario\"","class":"lineCov","hits":"1","order":"1529",},
{"lineNum":"  273","line":""},
{"lineNum":"  274","line":"  log.func_end_trace ${EXITCODE_SUCCESS}","class":"lineCov","hits":"1","order":"1530",},
{"lineNum":"  275","line":"}"},
{"lineNum":"  276","line":""},
{"lineNum":"  277","line":""},
{"lineNum":"  278","line":"function private.run_on_server() {"},
{"lineNum":"  279","line":"  log.func_start_trace \"$@\"","class":"lineCov","hits":"1","order":"1531",},
{"lineNum":"  280","line":""},
{"lineNum":"  281","line":"  local _run_opt=\"$1\"","class":"lineCov","hits":"1","order":"1532",},
{"lineNum":"  282","line":"  local _is_follow=\"$2\"","class":"lineCov","hits":"1","order":"1533",},
{"lineNum":"  283","line":"  shift 2","class":"lineCov","hits":"1","order":"1534",},
{"lineNum":"  284","line":"  local _target_scenarios=( \"$@\" )","class":"lineCov","hits":"1","order":"1535",},
{"lineNum":"  285","line":""},
{"lineNum":"  286","line":"  # scenarioディレクトリ存在チェック"},
{"lineNum":"  287","line":"  for _cur_scenario in ${_target_scenarios[*]}; do","class":"lineCov","hits":"1","order":"1536",},
{"lineNum":"  288","line":"    if [ ! -d \"${STFW_PROJ_DIR}/scenario/${_cur_scenario}\" ]; then","class":"lineCov","hits":"1","order":"1537",},
{"lineNum":"  289","line":"      log.error \"${STFW_PROJ_DIR}/scenario/${_cur_scenario} is not exist.\"","class":"lineNoCov","hits":"0",},
{"lineNum":"  290","line":"      return ${EXITCODE_ERROR}","class":"lineNoCov","hits":"0",},
{"lineNum":"  291","line":"    fi"},
{"lineNum":"  292","line":"  done"},
{"lineNum":"  293","line":""},
{"lineNum":"  294","line":"  # サーバ起動チェック"},
{"lineNum":"  295","line":"  if [[ \"$(stfw.digdag.server.is_running)\" != \"true\" ]]; then","class":"lineCov","hits":"1","order":"1538",},
{"lineNum":"  296","line":"    log.error \"digdag server is not running.\"","class":"lineNoCov","hits":"0",},
{"lineNum":"  297","line":"    return ${EXITCODE_ERROR}","class":"lineNoCov","hits":"0",},
{"lineNum":"  298","line":"  fi"},
{"lineNum":"  299","line":""},
{"lineNum":"  300","line":"  local _retcode=${EXITCODE_SUCCESS}","class":"lineCov","hits":"1","order":"1539",},
{"lineNum":"  301","line":""},
{"lineNum":"  302","line":"  # run_id発行"},
{"lineNum":"  303","line":"  local _run_id=$(private.get_run_id)","class":"lineCov","hits":"1","order":"1540",},
{"lineNum":"  304","line":""},
{"lineNum":"  305","line":"  # digdag projectディレクトリに必要なファイルをmove"},
{"lineNum":"  306","line":"  local _digdag_workspace_dir=\"${STFW_PROJ_DIR_DATA}/runs\"","class":"lineCov","hits":"1","order":"1541",},
{"lineNum":"  307","line":"  local _digdag_proj_dir=\"${_digdag_workspace_dir}/${_run_id}\"","class":"lineCov","hits":"1","order":"1542",},
{"lineNum":"  308","line":"  mkdir -p \"${_digdag_proj_dir}\"","class":"lineCov","hits":"1","order":"1543",},
{"lineNum":"  309","line":"  private.move_to_digdag_proj \"${_digdag_proj_dir}\" \"${_target_scenarios[@]}\"","class":"lineCov","hits":"1","order":"1544",},
{"lineNum":"  310","line":""},
{"lineNum":"  311","line":"  # run.dig作成"},
{"lineNum":"  312","line":"  stfw.generate.run-dig \"${_run_opt}\" \"${_run_id}\" \"${_digdag_proj_dir}\" \"${_target_scenarios[@]}\"","class":"lineCov","hits":"1","order":"1545",},
{"lineNum":"  313","line":""},
{"lineNum":"  314","line":"  # digdag push"},
{"lineNum":"  315","line":"  stfw.digdag.push \"${_digdag_proj_dir}\" \"${_run_id}\" \"${_target_scenarios[@]}\"","class":"lineCov","hits":"1","order":"1546",},
{"lineNum":"  316","line":"  _retcode=$?","class":"lineCov","hits":"1","order":"1547",},
{"lineNum":"  317","line":""},
{"lineNum":"  318","line":"  # digdag projectディレクトリからファイル群を戻す"},
{"lineNum":"  319","line":"  private.restore_moved_digdag_proj \"${_digdag_proj_dir}\"","class":"lineCov","hits":"1","order":"1548",},
{"lineNum":"  320","line":"  if [[ ${_retcode} -ne ${EXITCODE_SUCCESS} ]]; then return ${_retcode}; fi","class":"lineCov","hits":"1","order":"1549",},
{"lineNum":"  321","line":""},
{"lineNum":"  322","line":"  # push内容がsymlinkで動くようにdigdag projetディレクトリを生成"},
{"lineNum":"  323","line":"  private.gen_symlink_digdag_proj \"${_digdag_proj_dir}\" \"${_target_scenarios[@]}\"","class":"lineCov","hits":"1","order":"1550",},
{"lineNum":"  324","line":""},
{"lineNum":"  325","line":"  # stfw起動パラメータを保存"},
{"lineNum":"  326","line":"  stfw.set_raw_params \"${_digdag_proj_dir}\"","class":"lineCov","hits":"1","order":"1551",},
{"lineNum":"  327","line":""},
{"lineNum":"  328","line":"  # digdag start"},
{"lineNum":"  329","line":"  stfw.digdag.start \"${_digdag_proj_dir}\" \"${_run_id}\" \"$(basename ${FILENAME_DIG_RUN} .dig)\"","class":"lineCov","hits":"1","order":"1552",},
{"lineNum":"  330","line":"  _retcode=$?","class":"lineCov","hits":"1","order":"1553",},
{"lineNum":"  331","line":"  if [[ ${_retcode} -ne ${EXITCODE_SUCCESS} ]]; then return ${_retcode}; fi","class":"lineCov","hits":"1","order":"1554",},
{"lineNum":"  332","line":"  log.info \"start info\"","class":"lineCov","hits":"1","order":"1555",},
{"lineNum":"  333","line":"  log.add_indent","class":"lineCov","hits":"1","order":"1556",},
{"lineNum":"  334","line":"  log.info \"$(stfw.digdag.show_start_info ${_digdag_proj_dir})\"","class":"lineCov","hits":"1","order":"1557",},
{"lineNum":"  335","line":"  log.remove_indent","class":"lineCov","hits":"1","order":"1558",},
{"lineNum":"  336","line":""},
{"lineNum":"  337","line":"  # attempt id取得"},
{"lineNum":"  338","line":"  local _attempt_id=$(stfw.digdag.get_attempt_id \"${_digdag_proj_dir}\")","class":"lineCov","hits":"1","order":"1559",},
{"lineNum":"  339","line":"  if [[ \"${_attempt_id}x\" = \"x\" ]]; then return ${EXITCODE_ERROR}; fi","class":"lineCov","hits":"1","order":"1560",},
{"lineNum":"  340","line":""},
{"lineNum":"  341","line":"  # url表示"},
{"lineNum":"  342","line":"  local _ip=$(get_ip)","class":"lineCov","hits":"1","order":"1561",},
{"lineNum":"  343","line":"  # shellcheck disable=SC2154"},
{"lineNum":"  344","line":"  local _url_attempt=\"http://${_ip}:${stfw_server_port}/attempts/${_attempt_id}\"","class":"lineCov","hits":"1","order":"1562",},
{"lineNum":"  345","line":"  log.info \"If you want to check progress status on browser, execute \\`open ${_url_attempt}\\`\"","class":"lineCov","hits":"1","order":"1563",},
{"lineNum":"  346","line":""},
{"lineNum":"  347","line":"  # log follow"},
{"lineNum":"  348","line":"  if [[ \"${_is_follow}\" = \"true\" ]]; then","class":"lineCov","hits":"1","order":"1564",},
{"lineNum":"  349","line":"    stfw.digdag.log_follow \"${_digdag_proj_dir}\" \"${_attempt_id}\"","class":"lineCov","hits":"1","order":"1565",},
{"lineNum":"  350","line":"    _retcode=$?","class":"lineCov","hits":"1","order":"1566",},
{"lineNum":"  351","line":"  fi"},
{"lineNum":"  352","line":""},
{"lineNum":"  353","line":"  log.func_end_trace ${_retcode}","class":"lineCov","hits":"1","order":"1567",},
{"lineNum":"  354","line":"  return ${_retcode}","class":"lineCov","hits":"1","order":"1568",},
{"lineNum":"  355","line":"}"},
{"lineNum":"  356","line":""},
{"lineNum":"  357","line":""},
{"lineNum":"  358","line":"#---------------------------------------------------------------------------------------------------"},
{"lineNum":"  359","line":"# 事前処理"},
{"lineNum":"  360","line":"#---------------------------------------------------------------------------------------------------"},
{"lineNum":"  361","line":"#-------------------------------------------------------------------------------"},
{"lineNum":"  362","line":"# オプション解析"},
{"lineNum":"  363","line":"#-------------------------------------------------------------------------------"},
{"lineNum":"  364","line":"# 実行コマンド"},
{"lineNum":"  365","line":"cmd=\"\"","class":"lineCov","hits":"1","order":"1569",},
{"lineNum":"  366","line":"# run opt"},
{"lineNum":"  367","line":"run_opt=\"--run\"","class":"lineCov","hits":"1","order":"1570",},
{"lineNum":"  368","line":"# log followモード"},
{"lineNum":"  369","line":"is_follow=\"false\"","class":"lineCov","hits":"1","order":"1571",},
{"lineNum":"  370","line":""},
{"lineNum":"  371","line":"while :; do","class":"lineCov","hits":"1","order":"1572",},
{"lineNum":"  372","line":"  case $1 in","class":"lineCov","hits":"1","order":"1573",},
{"lineNum":"  373","line":"    --description)"},
{"lineNum":"  374","line":"      private.description","class":"lineNoCov","hits":"0",},
{"lineNum":"  375","line":"      exit ${EXITCODE_ERROR}","class":"lineNoCov","hits":"0",},
{"lineNum":"  376","line":"      ;;"},
{"lineNum":"  377","line":""},
{"lineNum":"  378","line":"    -h|--help)"},
{"lineNum":"  379","line":"      private.usage","class":"lineNoCov","hits":"0",},
{"lineNum":"  380","line":"      exit ${EXITCODE_ERROR}","class":"lineNoCov","hits":"0",},
{"lineNum":"  381","line":"      ;;"},
{"lineNum":"  382","line":""},
{"lineNum":"  383","line":"    -s|--setup)"},
{"lineNum":"  384","line":"      if [[ \"${cmd}x\" != \"x\" ]]; then private.usage; fi","class":"lineNoCov","hits":"0",},
{"lineNum":"  385","line":"      cmd=\"setup\"","class":"lineNoCov","hits":"0",},
{"lineNum":"  386","line":"      shift","class":"lineNoCov","hits":"0",},
{"lineNum":"  387","line":"      ;;"},
{"lineNum":"  388","line":""},
{"lineNum":"  389","line":"    -t|--teardown)"},
{"lineNum":"  390","line":"      if [[ \"${cmd}x\" != \"x\" ]]; then private.usage; fi","class":"lineNoCov","hits":"0",},
{"lineNum":"  391","line":"      cmd=\"teardown\"","class":"lineNoCov","hits":"0",},
{"lineNum":"  392","line":"      shift","class":"lineNoCov","hits":"0",},
{"lineNum":"  393","line":"      ;;"},
{"lineNum":"  394","line":""},
{"lineNum":"  395","line":"    -d|--dry-run)"},
{"lineNum":"  396","line":"      run_opt=\"--dry-run\"","class":"lineNoCov","hits":"0",},
{"lineNum":"  397","line":"      shift","class":"lineNoCov","hits":"0",},
{"lineNum":"  398","line":"      ;;"},
{"lineNum":"  399","line":""},
{"lineNum":"  400","line":"    -f|--follow)"},
{"lineNum":"  401","line":"      is_follow=\"true\"","class":"lineCov","hits":"1","order":"1574",},
{"lineNum":"  402","line":"      shift","class":"lineCov","hits":"1","order":"1575",},
{"lineNum":"  403","line":"      ;;"},
{"lineNum":"  404","line":""},
{"lineNum":"  405","line":"    --)"},
{"lineNum":"  406","line":"      shift","class":"lineNoCov","hits":"0",},
{"lineNum":"  407","line":"      break","class":"lineNoCov","hits":"0",},
{"lineNum":"  408","line":"      ;;"},
{"lineNum":"  409","line":""},
{"lineNum":"  410","line":"    *)"},
{"lineNum":"  411","line":"      break","class":"lineCov","hits":"1","order":"1576",},
{"lineNum":"  412","line":"      ;;"},
{"lineNum":"  413","line":"  esac"},
{"lineNum":"  414","line":"done"},
{"lineNum":"  415","line":""},
{"lineNum":"  416","line":"# デフォルト設定"},
{"lineNum":"  417","line":"if [[ \"${cmd}x\" = \"x\" ]]; then cmd=\"run_on_server\"; fi","class":"lineCov","hits":"1","order":"1577",},
{"lineNum":"  418","line":""},
{"lineNum":"  419","line":"# 引数チェック"},
{"lineNum":"  420","line":"if [[ $# -lt 1 ]]; then","class":"lineCov","hits":"1","order":"1578",},
{"lineNum":"  421","line":"  private.usage","class":"lineNoCov","hits":"0",},
{"lineNum":"  422","line":"fi"},
{"lineNum":"  423","line":""},
{"lineNum":"  424","line":"# シナリオリスト"},
{"lineNum":"  425","line":"target_scenarios=( \"$*\" )","class":"lineCov","hits":"1","order":"1579",},
{"lineNum":"  426","line":""},
{"lineNum":"  427","line":""},
{"lineNum":"  428","line":"#---------------------------------------------------------------------------------------------------"},
{"lineNum":"  429","line":"# 本処理"},
{"lineNum":"  430","line":"#---------------------------------------------------------------------------------------------------"},
{"lineNum":"  431","line":"log.script_start \"${PROGNAME} ${cmd}\"","class":"lineCov","hits":"1","order":"1580",},
{"lineNum":"  432","line":""},
{"lineNum":"  433","line":"#-------------------------------------------------------------------------------"},
{"lineNum":"  434","line":"# 引数解析"},
{"lineNum":"  435","line":"#-------------------------------------------------------------------------------"},
{"lineNum":"  436","line":"# コマンド実行"},
{"lineNum":"  437","line":"case ${cmd} in","class":"lineCov","hits":"1","order":"1581",},
{"lineNum":"  438","line":"  run_on_server)"},
{"lineNum":"  439","line":"    private.run_on_server \"${run_opt}\" \"${is_follow}\" \"${target_scenarios[@]}\"","class":"lineCov","hits":"1","order":"1582",},
{"lineNum":"  440","line":"    ;;"},
{"lineNum":"  441","line":""},
{"lineNum":"  442","line":"  setup)"},
{"lineNum":"  443","line":"    private.setup \"${target_scenarios[@]}\"","class":"lineNoCov","hits":"0",},
{"lineNum":"  444","line":"    ;;"},
{"lineNum":"  445","line":""},
{"lineNum":"  446","line":"  teardown)"},
{"lineNum":"  447","line":"    private.teardown \"${target_scenarios[@]}\"","class":"lineNoCov","hits":"0",},
{"lineNum":"  448","line":"    ;;"},
{"lineNum":"  449","line":""},
{"lineNum":"  450","line":"  *)"},
{"lineNum":"  451","line":"    private.usage","class":"lineNoCov","hits":"0",},
{"lineNum":"  452","line":"    exit ${EXITCODE_ERROR}","class":"lineNoCov","hits":"0",},
{"lineNum":"  453","line":"    ;;"},
{"lineNum":"  454","line":"esac"},
{"lineNum":"  455","line":"exitcode=$?","class":"lineCov","hits":"1","order":"1583",},
{"lineNum":"  456","line":""},
{"lineNum":"  457","line":"log.script_end \"${PROGNAME} ${cmd}\" \"${exitcode}\"","class":"lineCov","hits":"1","order":"1584",},
{"lineNum":"  458","line":"exit ${exitcode}","class":"lineCov","hits":"1","order":"1585",},
]};
var percent_low = 25;var percent_high = 75;
var header = { "command" : "integration_test.sh", "date" : "2018-02-01 19:13:29", "instrumented" : 211, "covered" : 146,};
var merged_data = [];
